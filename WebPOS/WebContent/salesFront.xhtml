<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:c="http://java.sun.com/jsp/jstl/core"
	xmlns:p="http://primefaces.org/ui">

<h:head>
	<h:outputStylesheet name="webjars/font-awesome/4.4.0/css/font-awesome.css"/>
	<link href="#{request.contextPath}/css/sales.css" rel="stylesheet"
		type="text/css" />
	<title><ui:insert name="title">#{bundle['sales.title']}</ui:insert></title>
</h:head>

<!-- Test if user is logged in. -->
<c:if test="#{userBean.name eq null}">
	<f:event type="preRenderView" listener="#{userBean.redirect}" />
	<f:attribute name="page" value="login" />
</c:if>

<!-- POPULATE CUSTOMERS -->
<f:event type="preRenderView" listener="#{customerBean.getCustomers}" />

<h:body>
	<p:layout fullPage="true">
		<p:layoutUnit position="north">
		<div class="header">
		<div class="headerText">
			<div class="tileName">
				<p>
					<span class="glyphicon glyphicon-arrow-left"></span> <a
						href="dash.xhtml">#{bundle['webpos.return']}</a>
				</p>
			</div>
		</div>
	</div>
	</p:layoutUnit>
	<p:layoutUnit position="west" resizable="true" size="150" minSize="100" maxSize="250">
		<p:fieldset legend="Customer Info" toggleable="true" toggleSpeed="200">
	        <h:panelGrid columns="1" cellpadding="5">
       			<p:commandButton value="Select Customer" icon="fa fa-child" styleClass="ui-ribbon-bigbutton" style="width:100px" type="button" onclick="PF('customer').show();"/>
	        </h:panelGrid>
	        <h:panelGrid>
	        	<h:outputText id="sName" value="#{customerBean.selectedCustomer.fullName}" rendered="#{customerBean.selectedCustomer.fullName != null}"/>
	        	<h:outputText id="sAddress" value="#{customerBean.selectedCustomer.address.postcode}" rendered="#{customerBean.selectedCustomer.address != null} value=" />
	        	<h:outputText id="sContact" value="#{customerBean.selectedCustomer.email}" rendered="#{customerBean.selectedCustomer.email != null}" />
	        	<h:outputText id="sContact" value="#{customerBean.selectedCustomer.mobileNumber}" rendered="#{customerBean.selectedCustomer.mobileNumber != null}" />	        	    	
	        	<h:outputText id="sContact" value="#{customerBean.selectedCustomer.homeNumber}" rendered="#{customerBean.selectedCustomer.homeNumber != null}" />	        	    	
	        </h:panelGrid>
    	</p:fieldset>
    	<p:fieldset legend="Stock Search" toggleable="true" toggleSpeed="200">
	        <h:panelGrid columns="1" cellpadding="5">
      			Stock Search
				<h:inputText id="search" value="#{stockRecordBean.sellPrice}">
				</h:inputText>
	        </h:panelGrid>
    	</p:fieldset>
	</p:layoutUnit>
	<p:layoutUnit position="east" resizable="true">
		<p:fieldset legend="Settle" toggleable="true" toggleSpeed="200">
	        <h:panelGrid columns="1" cellpadding="5">
       			<p:commandButton value="Cash" icon="fa fa fa-gbp" styleClass="ui-ribbon-bigbutton"
					style="width:100px" type="button" />
				<p:commandButton value="Card" icon="fa fa-credit-card" styleClass="ui-ribbon-bigbutton"
					style="width:100px" type="button" />
				<p:commandButton value="Voucher" icon="fa fa-file-text-o" styleClass="ui-ribbon-bigbutton"
					style="width:100px" type="button" />
	        </h:panelGrid>
    	</p:fieldset>
	</p:layoutUnit>
	<p:layoutUnit position="center">	
		<p:dataTable var="transactions" value="">
		    <p:column headerText="Qty.">
		        <h:outputText value="" />
		    </p:column>		 
		    <p:column headerText="Name">
		        <h:outputText value="" />
		    </p:column>		 
		    <p:column headerText="Value">
		        <h:outputText value="" />
		    </p:column>
		</p:dataTable>
	</p:layoutUnit>
		<p:layoutUnit position="south" resizable="true">	        
	        <p:ribbon>
	        	<p:tab title="Sell">
	        		<p:ribbonGroup label="">
						<p:commandButton value="Quantity" icon="fa fa-asterisk" styleClass="ui-ribbon-bigbutton" style="width:100px" type="button" onclick="PF('quantity').show();"/>
						<p:commandButton value="Discount" icon="fa fa-tag" styleClass="ui-ribbon-bigbutton" style="width:100px" type="button" />
					</p:ribbonGroup>
					<p:ribbonGroup label="">
						<p:commandButton value="Misc. Item" icon="fa fa-plus" styleClass="ui-ribbon-bigbutton" style="width:100px" type="button" />
						<p:commandButton value="Deposit" icon="fa fa-bookmark-o" styleClass="ui-ribbon-bigbutton"
							style="width:100px" type="button" />
					</p:ribbonGroup>
					<p:ribbonGroup label="">
						<p:commandButton value="Void Item" icon="fa fa-times-circle" styleClass="ui-ribbon-bigbutton" style="width:100px" type="button" />
						<p:commandButton value="Discard Transaction" icon="fa fa-trash" styleClass="ui-ribbon-bigbutton" style="width:100px" type="button" />
					</p:ribbonGroup>
	        	</p:tab>
	        	<p:tab title="Buy">
					<p:ribbonGroup label="">
						<p:commandButton value="Book for Test" icon="fa fa-sign-in" styleClass="ui-ribbon-bigbutton" style="width:100px" type="button" />
						<p:commandButton value="Check Tests" icon="fa fa-sign-out" styleClass="ui-ribbon-bigbutton" style="width:100px" type="button" />
					</p:ribbonGroup>
					<p:ribbonGroup label="">
						<p:commandButton value="Buy In" icon="fa fa-shopping-cart" styleClass="ui-ribbon-bigbutton" style="width:100px" type="button" />
						<p:commandButton value="Buy Back" icon="fa fa-calendar" styleClass="ui-ribbon-bigbutton"
						style="width:100px" type="button" />
					</p:ribbonGroup>
				</p:tab>
				<p:tab title="Refunds">
					<p:ribbonGroup label="">
						<p:commandButton value="Book for Waranty Test" icon="fa fa-stethoscope" styleClass="ui-ribbon-bigbutton" style="width:100px" type="button" />
						<!-- TEST IF USER IS ADMIN -->
						<c:if test="#{userBean.userType eq 1}">
							<p:commandButton value="Refund" icon="fa fa-money" styleClass="ui-ribbon-bigbutton" style="width:100px" type="button" />
						</c:if>
						<p:commandButton value="Exchange" icon="fa fa-arrows-h" styleClass="ui-ribbon-bigbutton"	style="width:100px" type="button" />
					</p:ribbonGroup>
				</p:tab>
				<p:tab title="Misc.">
					<p:ribbonGroup label="">
						<p:commandButton value="Reprint Receipt" icon="fa fa-print" styleClass="ui-ribbon-bigbutton" style="width:100px" type="button" />
						<!-- TEST IF USER IS ADMIN -->
						<c:if test="#{userBean.userType eq 1}">
							<p:commandButton value="Paid Out" icon="fa fa-eject" styleClass="ui-ribbon-bigbutton" style="width:100px" type="button" />
						</c:if>
					</p:ribbonGroup>
					<p:ribbonGroup label="">
						<c:if test="#{userBean.userType eq 1}">
							<p:commandButton value="Online Sale" icon="fa fa-paper-plane" styleClass="ui-ribbon-bigbutton" style="width:100px" type="button" />
						</c:if>
					</p:ribbonGroup>
				</p:tab>
	        </p:ribbon>
	    </p:layoutUnit>
	</p:layout>
	
<!-- MODALS -->
<!-- CUSTOMER SELECTOR -->
<p:dialog header="Customer" widgetVar="customer" modal="true" height="600" width="550">
	<p:tabView>
		<p:tab title="Existing Customer">
			<h:form id="customerSelector">
				<p:messages id="selectMessage" showDetail="true" autoUpdate="true" closable="true"/>
				<p:outputLabel value="Last Name: " for="customer"></p:outputLabel>
				<p:selectOneMenu id="customer" value="#{customerBean.selectedCustomer}" effect="fade" var="c" filter="true" filterMatchMode="startsWith" converter="customerConverter" panelStyle="width:180px">
					<f:selectItems value="#{customerBean.customerList}" var="customer" itemLabel="#{customer.lastName}" itemValue="#{customer}"/>
					<p:column>
						<h:outputText value="#{c.lastName}" />
					</p:column>
					<p:column>
						<h:outputText value="#{c.firstNames}" />
					</p:column>
				</p:selectOneMenu>
				<div id="buttons">
					<p:commandButton value="Select User" action="#{customerBean.validateCustomer}" process="@form"></p:commandButton>
				</div>
				<h:messages> </h:messages>
			</h:form>	
		</p:tab>
		
		<p:tab title="New Customer">
			<h:form id="newCustomer">
				<div id="newFirstNames">
					First Names:				
					<p:inputText id="ncFirstNames" value="#{customerBean.firstNames}" />
				</div>
				<div id="newLastName">
					Last Names:
					<p:inputText id="ncLastName" value="#{customerBean.lastName}" />
				</div>	
				<hr></hr>
				<div id="newHouseNmber">
					House Number:
					<p:inputText id="ncHouseNumber" value="#{customerBean.houseNumber}" />
				</div>
				<div id="newBuilding">
					Building (Optional):
					<h:inputText id="ncBuildingName" value="#{customerBean.buildingName}" />
				</div>
				<div id="newStreet">
					Street Name:
					<h:inputText id="ncStreetName" value="#{customerBean.streetName}" />
				</div>
				<div id="city">
					City:
					<h:inputText id="ncCity" value="#{customerBean.city}" />
				</div>
				<div id="newcounty">
					County:
					<h:inputText id="ncCounty" value="#{customerBean.county}" />
				</div>
				<div id="newPostcode">
					Postcode:
					<h:inputText id="ncPostcode" value="#{customerBean.postcode}" />
				</div>
				<hr></hr>
				<div id="newMobileNumber">
					Mobile Phone Number:
					<h:inputText id="ncMobileNumber" value="#{customerBean.mobileNumber}"/>
				</div>
				<div id="newHomeNumber">
					Home Phone Number:
					<h:inputText id="ncHomeNumber" value="#{customerBean.homeNumber}" />
				</div>
				<div id="newEmail">
					Email:
					<h:inputText id="ncEmail" value="#{customerBean.email}" />
				</div>
				<hr></hr>
				<div id="newDOB">
					Date of Birth:
					 <p:calendar id="button" value="#{customerBean.dateOfBirth}" showOn="button"/>
				</div>
				<div id="newID">
					ID Type:
					<h:inputText id="ncIDType" value="#{customerBean.idType}" />
				</div>
				<div id="newIDNumber">
					ID Number:
					<h:inputText id="ncIDNumber" value="#{customerBean.idNumber}" />
				</div>
				<div id ="newBooleans">
					Member of Staff:
					<h:selectBooleanCheckbox value="#{customerBean.staff}" />
				</div>
				<p:commandButton value="Create and Select User" id="button1" process="@form" action="#{customerBean.createCustomer}" onevent="function(data) { resetFormVal(data); })"></p:commandButton>
			</h:form>
		</p:tab>
	</p:tabView>    
</p:dialog>

<!-- QUANTITY -->
<p:dialog header="Quantity" widgetVar="quantity" modal="true" height="100">
     <h:panelGrid columns="1" cellpadding="5">
  		Quantity
		<h:inputText id="quantity" value="#{stockRecordBean.sellPrice}"/>
     </h:panelGrid>    	
</p:dialog>

</h:body>
</html>
