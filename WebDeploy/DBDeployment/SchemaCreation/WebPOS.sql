/*Schema for creating a table of users*/
CREATE TABLE `tbl_user` (
  `USER_ID` int(11) NOT NULL AUTO_INCREMENT,
  `USER_NAME` varchar(45) NOT NULL,
  `PASSWORD` varchar(45) NOT NULL,
  `USERTYPE` varchar(45) NOT NULL,
  PRIMARY KEY (`USER_ID`),
  UNIQUE KEY `USER_ID_UNIQUE` (`USER_ID`)
) ENGINE=InnoDB AUTO_INCREMENT=7 DEFAULT CHARSET=utf8;


/*Schema for creating a stock record table*/
CREATE TABLE `tbl_record` (
  `REC_ID` int(12) zerofill NOT NULL,
  `REC_NAME` varchar(45) NOT NULL,
  `REC_CATEGORY_ID` int(11) NOT NULL,
  `REC_SELL` double NOT NULL,
  `REC_CASH` double NOT NULL,
  `REC_EXCHANGE` double NOT NULL,
  `REC_NOTE` varchar(1000) DEFAULT NULL,
  `REC_KEYWORDS` varchar(1000) DEFAULT NULL,
  `REC_REQ_SERIAL` tinyint(1) NOT NULL,
  `REC_REQ_TEST` tinyint(1) NOT NULL,
  `REC_SEARCHTERMS` varchar(1000) DEFAULT NULL,
  PRIMARY KEY (`REC_ID`),
  UNIQUE KEY `REC_ID_UNIQUE` (`REC_ID`),
  KEY `FK_CATEGORY_ID_idx` (`REC_CATEGORY_ID`),
  CONSTRAINT `FK_CATEGORY_ID` FOREIGN KEY (`REC_CATEGORY_ID`) REFERENCES `tbl_category` (`CAT_ID`) ON DELETE NO ACTION ON UPDATE NO ACTION
) ENGINE=InnoDB DEFAULT CHARSET=utf8;

  
  /*Schema for creating a stock item table*/
CREATE TABLE `tbl_stock` (
  `STOCK_ID` int(11) NOT NULL AUTO_INCREMENT,
  `STOCK_REC_ID` int(11) NOT NULL,
  `STOCK_NAME` varchar(45) NOT NULL,
  `STOCK_SERIAL` varchar(45) DEFAULT NULL,
  `STOCK_IS_FAULTY` int(11) NOT NULL,
  `STOCK_FAULT_NOTE` varchar(45) DEFAULT NULL,
  `STOCK_HAS_SOLD` int(11) NOT NULL,
  `STOCK_SOLD_CASH` int(11) DEFAULT NULL,
  `STOCK_BOUGHT_CASH` int(11) DEFAULT NULL,
  `STOCK_BOUGHT_EXCHANGE` int(11) DEFAULT NULL,
  PRIMARY KEY (`STOCK_ID`),
  UNIQUE KEY `STOCK_ID_UNIQUE` (`STOCK_ID`),
  KEY `FK_StockRecordID_idx` (`STOCK_REC_ID`),
  CONSTRAINT `FK_StockRecordID` FOREIGN KEY (`STOCK_REC_ID`) REFERENCES `tbl_record` (`REC_ID`) ON DELETE NO ACTION ON UPDATE NO ACTION
) ENGINE=InnoDB DEFAULT CHARSET=utf8;

  
  /*Schema for creating a category table*/
CREATE TABLE `tbl_category` (
  `CAT_ID` int(11) NOT NULL AUTO_INCREMENT,
  `CAT_NAME` varchar(45) NOT NULL,
  PRIMARY KEY (`CAT_ID`),
  UNIQUE KEY `REC_CATEGORY_UNIQUE` (`CAT_NAME`),
  UNIQUE KEY `REC_ID_UNIQUE` (`CAT_ID`)
) ENGINE=InnoDB AUTO_INCREMENT=26 DEFAULT CHARSET=utf8;

  
  /*SQL to add Stock Record's ID as a foreign key to Stock Item table*/   
  ALTER TABLE `webpos`.`tbl_stock` 
ADD INDEX `FK_StockRecordID_idx` (`STOCK_REC_ID` ASC);
ALTER TABLE `webpos`.`tbl_stock` 
ADD CONSTRAINT `FK_StockRecordID`
  FOREIGN KEY (`STOCK_REC_ID`)
  REFERENCES `webpos`.`tbl_record` (`REC_ID`)
  ON DELETE NO ACTION
  ON UPDATE NO ACTION;

  /*SQL for creating a Test table*/
CREATE TABLE `tbl_test` (
  `TEST_ID` int(11) NOT NULL AUTO_INCREMENT,
  `TEST_DATETIME` datetime NOT NULL,
  `TEST_BOOKER_ID` int(11) NOT NULL,
  `TEST_TESTER_ID` int(11) DEFAULT NULL,
  `TEST_CHECKER_ID` int(11) DEFAULT NULL,
  `TEST_STOCKRECORD_ID` int(11) NOT NULL,
  `TEST_SERIAL` varchar(100) DEFAULT NULL,
  `TEST_STATUS` tinyint(1) NOT NULL,
  `TEST_DO_NOT_FORMAT` tinyint(1) NOT NULL,
  `TEST_CUSTOMER_ID` int(11) NOT NULL,
  PRIMARY KEY (`TEST_ID`),
  UNIQUE KEY `idtbl_test_UNIQUE` (`TEST_ID`),
  KEY `FK_TESTER_ID_idx` (`TEST_TESTER_ID`),
  KEY `FK_BOOKER_ID_idx` (`TEST_BOOKER_ID`),
  KEY `FK_CHECKER_ID_idx` (`TEST_CHECKER_ID`),
  KEY `FK_STOCK_ID_idx` (`TEST_STOCKRECORD_ID`),
  KEY `FK_CUSTOMER_ID_idx` (`TEST_CUSTOMER_ID`),
  CONSTRAINT `FK_BOOKER_ID` FOREIGN KEY (`TEST_BOOKER_ID`) REFERENCES `tbl_user` (`USER_ID`) ON DELETE NO ACTION ON UPDATE NO ACTION,
  CONSTRAINT `FK_CHECKER_ID` FOREIGN KEY (`TEST_CHECKER_ID`) REFERENCES `tbl_user` (`USER_ID`) ON DELETE NO ACTION ON UPDATE NO ACTION,
  CONSTRAINT `FK_CUSTOMER_ID` FOREIGN KEY (`TEST_CUSTOMER_ID`) REFERENCES `tbl_customer` (`CUSTOMER_ID`) ON DELETE NO ACTION ON UPDATE NO ACTION,
  CONSTRAINT `FK_STOCK_ID` FOREIGN KEY (`TEST_STOCKRECORD_ID`) REFERENCES `tbl_record` (`REC_ID`) ON DELETE NO ACTION ON UPDATE NO ACTION,
  CONSTRAINT `FK_TESTER_ID` FOREIGN KEY (`TEST_TESTER_ID`) REFERENCES `tbl_user` (`USER_ID`) ON DELETE NO ACTION ON UPDATE NO ACTION
) ENGINE=InnoDB AUTO_INCREMENT=2 DEFAULT CHARSET=utf8;
